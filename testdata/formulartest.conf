WM(
 Formular(
   TITLE "SA 98.x Abtretungserklärung"
   Fenster( # Heisst Fenster wg. Analogie zu AbsenderdatenBearbeiten, ausserdem 
            # evtl. Realisierung über Fenster statt Tabs
     Empfaenger(
       TITLE "Empfänger"
       CLOSEACTION "abort"
       TIP "Wer soll's kriegen?"
       HOTKEY "E"
       
       Eingabefelder(
         (LABEL "Anrede" TIP "Anrede des Empfängers" TYPE "combobox" 
            VALUES ("Herr", "Frau") ID "EmpfaengerAnrede" TIP "Ja was wohl?"
            
            AUTOFILL(DIALOG("Empfaengerauswahl","Anrede"))
         )
         
         (LABEL "Nicht-Editierbar fishy" TYPE "combobox" VALUES ("11111", "22222") ID "NEFishy" EDIT "false" )
         (LABEL "Nicht-Editierbar preset in list" TYPE "combobox" VALUES ("Dieses", "Dings", "Bums") ID "NEPresetInList" EDIT "false" )
         (LABEL "Nicht-Editierbar preset not in list" TYPE "combobox" VALUES ("Dieses", "Dings", "Bums") ID "NEPresetNotInList" EDIT "false" )
         
         (LABEL "Editierbar fishy" TYPE "combobox" VALUES ("11111", "22222") ID "EFishy" EDIT "true")
         (LABEL "Editierbar preset in list" TYPE "combobox" VALUES ("Dieses", "Dings", "Bums") ID "EPresetInList" EDIT "true" )
         (LABEL "Editierbar preset not in list" TYPE "combobox" VALUES ("Dieses", "Dings", "Bums") ID "EPresetNotInList" EDIT "true" )
         
         
         (LABEL "Vorname" TYPE "textfield" ID "EmpfaengerVorname" 
            TIP "Ist doch selbsterklärend"
            AUTOFILL(DIALOG("Empfaengerauswahl","Vorname"))
         )

         (LABEL "Kopie von Vorname" TYPE "textfield" ID "kopie" 
            AUTOFILL(VALUE("EmpfaengerVorname"))
         )
         (LABEL "Kopie von Kopie von Vorname" TYPE "textfield" ID "kopiekopie" 
            AUTOFILL(VALUE("kopie"))
         )
            
         (LABEL "Nachname" TYPE "textfield" ID "EmpfaengerNachname"
            AUTOFILL(CAT(VALUE("EmpfaengerNachname2")VALUE("EmpfaengerNachname2")))
         )
         
         (LABEL "Nachname2" TYPE "textfield" ID "EmpfaengerNachname2"
            AUTOFILL(CAT(VALUE("EmpfaengerNachname")VALUE("EmpfaengerNachname")))
         )
         
         (LABEL "Straße Hausnummer" TYPE "textfield" ID "EmpfaengerStrasse"
            AUTOFILL(DIALOG("Empfaengerauswahl","Strasse"))
         )
         (LABEL "PLZ" TYPE "textfield" ID "EmpfaengerPLZ"
            AUTOFILL(DIALOG("Empfaengerauswahl","PLZ"))
         )
         (LABEL "Ort" TYPE "textfield" ID "EmpfaengerOrt"
            AUTOFILL(DIALOG("Empfaengerauswahl","Ort"))
         )
         
         (LABEL "Besondere Merkmale" TYPE "textarea" LINES "4" ID "Merkmale" TIP "z.B. ""Hakennase"" oder ""Doppelkinn""")

         (TYPE "glue")
       )
       Buttons(
         (LABEL "Abbrechen"  TYPE "button" HOTKEY "A"  ACTION "abort" TIP "Hier klicken wenn Kaffeepause")
         (TYPE "glue" MINSIZE "20")
         (LABEL "Adressauswahl" TYPE "button" HOTKEY "A"  ACTION "dbSelect" DIALOG "Empfaengerauswahl")
         (LABEL "<-Zurück"  TYPE "button" HOTKEY "Z"  ACTION "prevTab")
         (LABEL "Weiter->"  TYPE "button" HOTKEY "W"  ACTION "nextTab")
       )
     )
     
     Sicherungsgeber(
       TITLE "Sicherungsgeber"
       CLOSEACTION "abort"
       TIP "Wer geben?"
       HOTKEY "s"
       
       
       Eingabefelder(
         (LABEL "Anrede" TYPE "combobox" VALUES ("Herr", "Frau") ID "SGAnrede" 
            EDIT "true" 
         )
         (LABEL "Vorname(PLAUSI)" TYPE "textfield" ID "SGVorname" TIP "Darf nicht leer sein!"
           PLAUSI(MATCH(VALUE("SGVorname"), ".+"))
         )
         (LABEL "Nachname" TYPE "textfield" ID "SGNachname")
         (LABEL "wohnhaft in" TYPE "textfield" ID "SGAdresse")
         (TYPE "glue")
       )
       Buttons(
         (LABEL "Abbrechen"  TYPE "button" HOTKEY "A"  ACTION "abort")
         (TYPE "glue" MINSIZE "20")
         (LABEL "<-Zurück"  TYPE "button" HOTKEY "Z"  ACTION "prevTab")
         (LABEL "Weiter->"  TYPE "button" HOTKEY "W"  ACTION "nextTab")
       )
     )
       
     Darlehen(
       TITLE "Darlehen/Abtretungen"
       CLOSEACTION "abort"
       Eingabefelder(
         (LABEL "Darlehensbetrag (EUR)(PLAUSI)" TYPE "textfield" ID "DarlBetrag" 
             TIP "Muss eine Zahl sein, die zwischen 10000 und 50000 liegt"
            # Das Feld, das das Plausiattribut hat wird rot, wenn die Plausi false
            # liefert.
            # Die Plausi wird nur ausgewertet (insbes. bei Drucken-Knopf), wenn
            # alle Felder von denen ihre Bedingung abhängt UND das Rotzumarkierende Feld
            # sichtbar/eingeblendet sind.
            PLAUSI(BIND(FUNCTION 'ZahlenBereich' SET('min', '10000') SET('max', '50000') SET('wert', VALUE('DarlBetrag'))))

         )
         (LABEL "gewährt am (TT.MM.JJJJ)(PLAUSI)" TYPE "textfield" ID "DarlDatum" 
            TIP "Muss ein erlaubtes Datum sein"
            PLAUSI(BIND(FUNCTION 'Datum' SET('datum' VALUE('DarlDatum')))) 
         )
         (TYPE "separator")
         (LABEL "Der Sicherungsgeber tritt folgende Forderungen an die LHM ab:" TYPE "label")
         (LABEL "Lohn, Gehalt, Sozialleistungsansprüche" TYPE "checkbox" ID "AbtLohn")
         (LABEL "Genossenschaftsanteile" TYPE "checkbox" ID "AbtAnteile")
         (LABEL "Kaution für Wohnung" TYPE "checkbox" ID "AbtKaution")
         (LABEL "Lebensversicherung" TYPE "checkbox" ID "AbtVersicherung")
         (LABEL "Lohn und Kaution gesetzt" TYPE "checkbox" READONLY "true" AUTOFILL(VALUE("AbtLohn")VALUE("AbtKaution")))
         (TYPE "glue")
       )
       Buttons(
         (LABEL "Abbrechen" TYPE "button" HOTKEY "A"  ACTION "abort")
         (TYPE "glue" MINSIZE "20")
         (LABEL "<-Zurück"  TYPE "button" HOTKEY "Z"  ACTION "prevTab")
         (LABEL "Weiter->"  TYPE "button" HOTKEY "W"  ACTION "nextTab")
       )
     )
     
     Details(
       TITLE "Abtretung Details"
       CLOSEACTION "abort"
	     Eingabefelder(
	       (LABEL "Lohn, Gehalt, Sozialleistungsansprüche" TYPE "label" GROUPS("AbtLohn"))
	       (LABEL "gegen den" TYPE "combobox" GROUPS("AbtLohn") VALUES ("Arbeitgeber", "Dienstherren") ID "ArbeitgeberDienstherren" )
	       (LABEL "aus einem" TYPE "combobox" GROUPS("AbtLohn") VALUES ("Arbeitsverhältnis", "Dienstverhältnis") ID "ArbeitsverhaeltnisDienstverhaeltnis" )
	       
	       (TYPE "separator" GROUPS "AbtAnteile")
	       
	       (LABEL "Genossenschaftsanteile" TYPE "label" GROUPS("AbtAnteile"))
	       (LABEL "Anspruch auf Rückzahlung" TYPE "combobox" GROUPS("AbtAnteile") VALUES ("des Genossenschaftsanteils", "der Genossenschaftsanteile") ID "DesDerGenossenschaftsanteileS" )
	       (LABEL "in Höhe von (EUR)" TYPE "textfield" GROUPS("AbtAnteile") ID "GABetrag" )
	       (LABEL "gegen" TYPE "textfield" GROUPS("AbtAnteile") ID "Genossenschaft" )
	       
	       (TYPE "separator" GROUPS "AbtKaution" )
	
	       (LABEL "Kaution für Wohnung" TYPE "label" GROUPS("AbtKaution"))
	       (LABEL "Adresse" TYPE "textfield" GROUPS("AbtKaution") ID "KautionWohnungAdresse" )
	       (LABEL "in Höhe von (EUR)" TYPE "textfield" GROUPS("AbtKaution") ID "KautionWohnungBetrag" )
	
	       (TYPE "separator" GROUPS "AbtVersicherung")
	
	       (LABEL "Lebensversicherung" TYPE "label" GROUPS("AbtVersicherung"))
	       (LABEL "Versicherungs-Nr." TYPE "textfield" GROUPS("AbtVersicherung") ID "Versicherungsnummer" )
	       (LABEL "bei Institut" TYPE "textfield" GROUPS("AbtVersicherung") ID "Versicherungsinstitut" )
	
	       (TYPE "glue")
	     )
	     Buttons(
	       (LABEL "Abbrechen"  TYPE "button" HOTKEY "A"  ACTION "abort")
	       (TYPE "glue" MINSIZE "20")
	       (LABEL "<-Zurück"  TYPE "button" HOTKEY "Z"  ACTION "prevTab")
	       (LABEL "Weiter->"  TYPE "button" HOTKEY "W"  ACTION "nextTab")
	     )
	   )  
   )
   
   Sichtbarkeit
   (
     AbtLohn(VALUE("AbtLohn"))
     AbtAnteile(VALUE("AbtAnteile"))
     AbtKaution(MATCH(VALUE("AbtKaution"),"true"))
     AbtVersicherung(VALUE("AbtVersicherung"))
   )

   Funktionen #global in wollmux.conf, nicht so sinnvoll in Formularbeschreibung selbst
   (
     #AnredeSuffix(EXTERN(URL "vnd.sun.star.script:WollMux.Trafo.MannOderFrau?language=Basic&location=application" PARAMS("Anrede", "SuffixWeibl", "SuffixMaennl")))
     #SGAnredederdie(BIND( FUNCTION("AnredeSuffix") SET("AnredeWeibl" "die") SET("AnredeMaennl" "der" ) SET("Anrede" VALUE("SGAnrede")))
     #SGAnredeDerDie(FUNCTION( PARAM("Der","Die") DEPENDS "SGAnrede" URL "vnd.sun.star.script:WollMux.Trafo.MannOderFrau?language=Basic&location=application" ))
     #SGAnredeseinihr(FUNCTION( PARAM("sein","ihr") DEPENDS "SGAnrede" URL "vnd.sun.star.script:WollMux.Trafo.MannOderFrau?language=Basic&location=application" ))
     #SGAnreder(FUNCTION( PARAM("r","") DEPENDS "SGAnrede" URL "vnd.sun.star.script:WollMux.Trafo.MannOderFrau?language=Basic&location=application" ))
     #SGAnredein(FUNCTION( PARAM("","in") DEPENDS "SGAnrede" URL "vnd.sun.star.script:WollMux.Trafo.MannOderFrau?language=Basic&location=application" ))
     #NichtLeerNurBuchstaben(MATCH(ARG("Arg1"),"[a-zA-Z]+"))
     #funktionvonunten(FUNCTION( PARAM("arg1","arg2") DEPENDS "depend1" URL "vnd.sun.star.script:WollMux.Trafo.MannOderFrau?language=Basic&location=application" ))
     #FormatiereTel(LABEL "Telefonnumer formatieren" FUNCTION(URL "..." DEPENDS "nummerOhneLeerzeichen"))
     #CMD 'insertValue' DB_SPALTE 'Telefon' TRAFO 'FormatiereTel'
     #Entschuldigung(
     #  SELECT(
     #    IF( MATCH(VALUE("Status"), "abgelehnt") 
     #        THEN "Das tut uns aber traurig :-("  
     #    )
     #    IF( MATCH(VALUE("Status"), "angenommen") 
     #        THEN "Herzlichen Glückwunsch :-)"
     #    )
     #    ELSE "<Bitte Text einfügen>"
     #  )
     #)
     
       # Diese Funktion liefert "true" wenn  min <= wert <= max
     ZahlenBereich(EXTERN(URL "java:de.muenchen.allg.itd51.wollmux.func.Standard.zahlenBereich" 
            PARAMS("min", "max", "wert"))
     )
     
     Datum(
       EXTERN(URL "java:de.muenchen.allg.itd51.wollmux.func.Standard.korrektesDatum" 
            PARAMS("datum"))
     )
     
   ) #Funktionen
   
   Funktionsdialoge(
     Empfaengerauswahl()
   )
   
 )
)
